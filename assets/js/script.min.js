$(document).ready(function () {
    AOS.init({
        disable: "mobile"
    });
});

var firebaseConfig = {
    apiKey: "AIzaSyDmnvgNUMI7TGiTqsRy2YYpG9DOmEF39Zs",
    authDomain: "practice-713ca.firebaseapp.com",
    databaseURL: "https://practice-713ca.firebaseio.com",
    projectId: "practice-713ca",
    storageBucket: "practice-713ca.appspot.com",
    messagingSenderId: "192057578935",
    appId: "1:192057578935:web:7e77f7cf51fb93f3360432",
    measurementId: "G-X2JVWNL1VN"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);

var books = firebase.database().ref("books");
// -------------------------------------------------------------------------------------- //

let myLibrary = [];

function newcard(title, author, pages, read) {
    this.title = title;
    this.author = author;
    this.pages = pages;
    this.read = read;
}

const cont = document.getElementById("books");
const readKey = "mBy0Yn2xZEi4CdCvnIuvSA"

// listens for submit
document.getElementById("bookForm").addEventListener("submit", submitForm);
// listens for change in database
books.on("child_added", snap => {
    setContent(snap.val(), snap.key)
});

books.on("child_removed", snap => {
    let uniqueID = snap.key
    document.getElementById(uniqueID).remove()
});

function setContent(book, id) {
    let top = document.createElement("div");
    top.className = "card";
    top.id = id

    let body = document.createElement("div");
    body.className = "card-body";

    let cardTitle = document.createElement("h4");
    cardTitle.className = "card-title";
    cardTitle.innerHTML = book.title;

    let cardSub = document.createElement("h6");
    cardSub.className = "text-muted card-subtitle mb-2";
    cardSub.innerHTML = book.author;

    let cardText = document.createElement("p");
    cardText.className = "card-text";
    cardText.innerHTML = `This books has ${book.pages} number of pages and have you read it ? ${book.read}`

    body.appendChild(cardTitle);
    body.appendChild(cardSub);
    body.appendChild(cardText);
    top.appendChild(body);
    cont.appendChild(top);
    
    myLibrary.push(book)
}

// submit form handling
function submitForm(e) {
    e.preventDefault();
    var card = new newcard(
        getInputval("name"),
        getInputval("author"),
        getInputval("pages"),
        document.getElementById("formCheck-1").checked
    );

    key = saveBook(card);
    document.querySelector("#bookForm").reset();
}

// sends data to firebase database
function saveBook(book) {
    var newBook = books.push();
    newBook.set(book);
    return newBook.key
}

// Utility Function
function getInputval(id) {
    return document.getElementById(id).value;
}

// ------------------------------------------

